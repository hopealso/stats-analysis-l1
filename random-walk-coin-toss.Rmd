---
title: "Statistical Analysis, MSCA 31007, Lecture 1"
author: "Hope Foster-Reyes"
date: "September 29, 2016"
output: pdf_document
---

Explore the probabilities associated with the experiment of tossing a simulated fair coin multiple times.

## 1. Convergence of Probability of Tail to 0.5

```{r q1}
# Seed for reproducibility
set.seed(12345)

num.flips <- 100000
#num.flips <- 200000

# Create a random sample of num.flips coin flips, represented by 0 = Heads and 1 = Tails
# Store this sample in the vector flips
flips <- sample(0:1, num.flips, replace = T)

# Create a vector of length num.flips containing the cumulative sum of the flips, 
#   incrementing by 1 for each outcome of Tails
trajectory <- cumsum(flips)

# Create a vector of length num.flips containing the running frequency of of tails,
#   with each entry representing the calculated frequency after the nth flip
freq.tails <- trajectory / (1:num.flips)

# Create a line graph of all data in the tails frequency vector
plot(1:length(freq.tails), freq.tails, ylim = c(0.4, 1), type = "l", 
     ylab = "Frequency of Tails Outcome", xlab = "Sample Length", 
     main = "Tails Frequency Trajectory")
lines(c(0, num.flips), c(0.5, 0.5))

# Create a line graph honing in on the first 4000 entries in the tails frequency vector
plot(1:4000, freq.tails[1:4000], ylim = c(0.4, 1), type = "l", 
     ylab = "Frequency of Tails Outcome", xlab = "Sample Length", 
     main = "Tails Frequency Trajectory to 4000")
lines(c(0,4000), c(0.5, 0.5))
```

# a. 

**Does the frequency of Tails converge to 0.5 as the number of tosses grows? What does this say about the fairness of the coin?**

Theoretically, we know that in the long run the frequency of the outcome Tails in n trials should converge at 0.5 as n gets larger for a fair coin, with a fair coin being defined as one in which both outcomes, Heads and Tails are equallly likely.

This experiment demonstrates this phenomenon empirically, with our computer-generated pseudo-random simulation of a fair coin.

We know that the "coin" is fair because as the trajectory becomes larger and larger, we can see the frequency of flips with the outcome Tails moving closer and closer to 0.5, the number which represents the probability of rolling Tails when each outcome is equally likely. Thus the empirical frequency is converging on the theoretical probability.

At the 100,000th flip, the tail frequency is `r tail(freq.tails, 1)`.

# b.

**Interpret what you see on the graphs.**



```{r q1-b}
# Create a line graph honing in on the next 50000 entries in the tails frequency vector
plot(4000:54000, freq.tails[4000:54000], ylim = c(0.4, 0.6), type = "l", 
     ylab = "Frequency of Tails Outcome", xlab = "Sample Length", 
     main = "Tails Frequency Trajectory to 4000")
lines(c(4000,54000), c(0.5, 0.5))
```

